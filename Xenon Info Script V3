local Plr = game.Players.LocalPlayer
local RS = game:GetService("ReplicatedStorage")
local UIS = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")

local DataFolder = RS:WaitForChild("Data"):WaitForChild(Plr.Name)
local Str = DataFolder:WaitForChild("Strength")

local sessionStart = os.time() -- starts counting immediately

-- ===== PAGE 1 GUI =====
local StrCounterGUI = Instance.new("ScreenGui")
StrCounterGUI.Name = "XenonsStrengthGauge"
StrCounterGUI.IgnoreGuiInset = true
StrCounterGUI.ResetOnSpawn = true
StrCounterGUI.Parent = Plr:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Position = UDim2.new(0.33,0,0.4,0)
MainFrame.Size = UDim2.new(0,340,0,200)
MainFrame.BackgroundColor3 = Color3.new(0,0,0)
MainFrame.BorderSizePixel = 2
MainFrame.Parent = StrCounterGUI

local InnerFrame = Instance.new("Frame")
InnerFrame.Size = UDim2.new(1,-4,1,-4)
InnerFrame.Position = UDim2.new(0,2,0,2)
InnerFrame.BackgroundColor3 = Color3.new(1,1,1)
InnerFrame.BorderSizePixel = 0
InnerFrame.Parent = MainFrame

local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(255,50,50)),
	ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255,0,0)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(0,0,0))
}
Gradient.Rotation = 45
Gradient.Parent = InnerFrame

local TopTxt = Instance.new("TextLabel")
TopTxt.BackgroundTransparency = 1
TopTxt.Position = UDim2.new(0.05,0,0.03,0)
TopTxt.Size = UDim2.new(0.9,0,0.12,0)
TopTxt.Text = "Xenon Info Script V3"
TopTxt.TextColor3 = Color3.new(1,1,1)
TopTxt.Font = Enum.Font.GothamBold
TopTxt.TextSize = 20
TopTxt.TextStrokeTransparency = 0
TopTxt.Parent = InnerFrame

local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0,26,0,26)
CloseBtn.Position = UDim2.new(0,6,0,6)
CloseBtn.BackgroundColor3 = Color3.fromRGB(120,0,0)
CloseBtn.BorderSizePixel = 2
CloseBtn.BorderColor3 = Color3.fromRGB(255,80,80)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 18
CloseBtn.Parent = InnerFrame

CloseBtn.MouseButton1Click:Connect(function()
	StrCounterGUI:Destroy()
end)

pcall(function()
	game.StarterGui:SetCore("SendNotification", {
		Title = "Xenon Info Script V3",
		Text = "BEST INFO SCRIPT",
		Duration = 5
	})
end)

local StrTxt = Instance.new("TextLabel")
StrTxt.BackgroundTransparency = 1
StrTxt.Position = UDim2.new(0.05,0,0.2,0)
StrTxt.Size = UDim2.new(0.9,0,0.12,0)
StrTxt.Font = Enum.Font.GothamBold
StrTxt.TextColor3 = Color3.new(1,1,1)
StrTxt.TextSize = 22
StrTxt.TextStrokeTransparency = 0
StrTxt.Parent = InnerFrame

local ShortTxt = Instance.new("TextLabel")
ShortTxt.BackgroundTransparency = 1
ShortTxt.Position = UDim2.new(0.05,0,0.32,0)
ShortTxt.Size = UDim2.new(0.9,0,0.08,0)
ShortTxt.Font = Enum.Font.GothamBold
ShortTxt.TextColor3 = Color3.new(1,1,1)
ShortTxt.TextSize = 18
ShortTxt.TextStrokeTransparency = 0
ShortTxt.Parent = InnerFrame

local GainTxt = Instance.new("TextLabel")
GainTxt.BackgroundTransparency = 1
GainTxt.Position = UDim2.new(0.05,0,0.45,0)
GainTxt.Size = UDim2.new(0.9,0,0.5,0)
GainTxt.Font = Enum.Font.GothamBold
GainTxt.TextColor3 = Color3.new(1,1,1)
GainTxt.TextSize = 16
GainTxt.TextStrokeTransparency = 0
GainTxt.TextWrapped = true
GainTxt.TextYAlignment = Enum.TextYAlignment.Top
GainTxt.Parent = InnerFrame

local lastStrength = Str.Value
local earnedStrength = 0

local function formatNumberWithCommas(num)
	local formatted = tostring(math.floor(num))
	local k
	repeat
		formatted, k = string.gsub(formatted, "^(-?%d+)(%d%d%d)", "%1,%2")
	until k == 0
	return formatted
end

local function abbreviateNumber(num)
	local absNum = math.abs(num)
	if absNum < 1e3 then
		return tostring(num)
	elseif absNum < 1e6 then
		return string.format("%.2fK", num / 1e3):gsub("%.00K","K")
	elseif absNum < 1e9 then
		return string.format("%.2fM", num / 1e6):gsub("%.00M","M")
	elseif absNum < 1e12 then
		return string.format("%.2fB", num / 1e9):gsub("%.00B","B")
	elseif absNum < 1e15 then
		return string.format("%.2fT", num / 1e12):gsub("%.00T","T")
	else
		return tostring(num)
	end
end

task.spawn(function()
	while true do
		local current = Str.Value
		local gained = current - lastStrength
		if gained > 0 then
			earnedStrength += gained
		end

		StrTxt.Text = "Strength: "..formatNumberWithCommas(current)
		ShortTxt.Text = "("..abbreviateNumber(current)..")"

		GainTxt.Text = string.format(
			"SPS: %s (%s)\nSPM: %s (%s)\nSPH: %s (%s)\nSPD: %s (%s)\nSPW: %s (%s)",
			formatNumberWithCommas(gained), abbreviateNumber(gained),
			formatNumberWithCommas(gained*60), abbreviateNumber(gained*60),
			formatNumberWithCommas(gained*3600), abbreviateNumber(gained*3600),
			formatNumberWithCommas(gained*86400), abbreviateNumber(gained*86400),
			formatNumberWithCommas(gained*604800), abbreviateNumber(gained*604800)
		)

		lastStrength = current
		task.wait(1)
	end
end)

-- ===== PAGE 1 DRAG =====
local dragToggle, dragStart, startPos
local function updateInput(input)
	local delta = input.Position - dragStart
	MainFrame.Position = UDim2.new(
		startPos.X.Scale, startPos.X.Offset + delta.X,
		startPos.Y.Scale, startPos.Y.Offset + delta.Y
	)
end

MainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragToggle = true
		dragStart = input.Position
		startPos = MainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragToggle = false
			end
		end)
	end
end)

UIS.InputChanged:Connect(function(input)
	if dragToggle and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		updateInput(input)
	end
end)

-- ===== PAGE 2 TOGGLE =====
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Size = UDim2.new(0,28,0,28)
ToggleBtn.Position = UDim2.new(1,-34,0,6)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
ToggleBtn.BorderSizePixel = 2
ToggleBtn.BorderColor3 = Color3.fromRGB(255,80,80)
ToggleBtn.Text = ">"
ToggleBtn.TextColor3 = Color3.new(1,1,1)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.TextSize = 18
ToggleBtn.Parent = InnerFrame

local SecondPage
local pageOpen = false

-- ===== SKYBOX DATA =====
local Skyboxes = {
	{Name="Blue Heaven", SkyboxBk="rbxassetid://159454299", SkyboxDn="rbxassetid://159454296", SkyboxFt="rbxassetid://159454293", SkyboxLf="rbxassetid://159454286", SkyboxRt="rbxassetid://159454300", SkyboxUp="rbxassetid://159454288"},
	{Name="Purple Nebula", SkyboxBk="rbxassetid://433274085", SkyboxDn="rbxassetid://433274194", SkyboxFt="rbxassetid://433274131", SkyboxLf="rbxassetid://433274370", SkyboxRt="rbxassetid://433274429", SkyboxUp="rbxassetid://433274285"},
	{Name="Red Night", SkyboxBk="rbxassetid://401664839", SkyboxDn="rbxassetid://401664862", SkyboxFt="rbxassetid://401664960", SkyboxLf="rbxassetid://401664881", SkyboxRt="rbxassetid://401664901", SkyboxUp="rbxassetid://401664936"},
	{Name="Blue Night", SkyboxBk="rbxassetid://12064107", SkyboxDn="rbxassetid://12064152", SkyboxFt="rbxassetid://12064121", SkyboxLf="rbxassetid://12063984", SkyboxRt="rbxassetid://12064115", SkyboxUp="rbxassetid://12064131"},
	{Name="Blossom Daylight", SkyboxBk="rbxassetid://271042516", SkyboxDn="rbxassetid://271077243", SkyboxFt="rbxassetid://271042556", SkyboxLf="rbxassetid://271042310", SkyboxRt="rbxassetid://271042467", SkyboxUp="rbxassetid://271077958"}
}
local currentSkyIndex = 1

local function applySkybox(index)
	if Lighting:FindFirstChild("ExecutorSky") then
		Lighting.ExecutorSky:Destroy()
	end
	local data = Skyboxes[index]
	local sky = Instance.new("Sky")
	sky.Name = "ExecutorSky"
	sky.SkyboxBk = data.SkyboxBk
	sky.SkyboxDn = data.SkyboxDn
	sky.SkyboxFt = data.SkyboxFt
	sky.SkyboxLf = data.SkyboxLf
	sky.SkyboxRt = data.SkyboxRt
	sky.SkyboxUp = data.SkyboxUp
	sky.Parent = Lighting
end
applySkybox(currentSkyIndex)

ToggleBtn.MouseButton1Click:Connect(function()
	if not pageOpen then
		pageOpen = true
		ToggleBtn.Text = "<"

		-- ===== CREATE SECOND PAGE =====
		SecondPage = Instance.new("Frame")
		SecondPage.Size = UDim2.new(0,340,0,200)
		SecondPage.Position = UDim2.new(0, MainFrame.Position.X.Offset + MainFrame.Size.X.Offset, MainFrame.Position.Y.Scale, MainFrame.Position.Y.Offset)
		SecondPage.BackgroundColor3 = Color3.new(0,0,0)
		SecondPage.BorderSizePixel = 2
		SecondPage.Parent = StrCounterGUI

		local InnerSecond = Instance.new("Frame")
		InnerSecond.Size = UDim2.new(1,-4,1,-4)
		InnerSecond.Position = UDim2.new(0,2,0,2)
		InnerSecond.BackgroundColor3 = Color3.new(1,1,1)
		InnerSecond.BorderSizePixel = 0
		InnerSecond.Parent = SecondPage

		local Gradient2 = Instance.new("UIGradient")
		Gradient2.Color = ColorSequence.new{
			ColorSequenceKeypoint.new(0, Color3.fromRGB(200,50,130)),
			ColorSequenceKeypoint.new(0.3, Color3.fromRGB(100,0,150)),
			ColorSequenceKeypoint.new(0.7, Color3.fromRGB(0,0,0)),
			ColorSequenceKeypoint.new(1, Color3.fromRGB(120,120,25))
		}
		Gradient2.Rotation = 45
		Gradient2.Parent = InnerSecond

		-- ===== PAGE 2 STATS =====
		local EarnedTxt = Instance.new("TextLabel")
		EarnedTxt.BackgroundTransparency = 1
		EarnedTxt.Size = UDim2.new(0.9,0,0.15,0)
		EarnedTxt.Position = UDim2.new(0.05,0,0.03,0)
		EarnedTxt.Font = Enum.Font.GothamBold
		EarnedTxt.TextColor3 = Color3.new(1,1,1)
		EarnedTxt.TextSize = 20
		EarnedTxt.TextStrokeTransparency = 0
		EarnedTxt.TextWrapped = true
		EarnedTxt.Text = "Earned: "..formatNumberWithCommas(earnedStrength).." ("..abbreviateNumber(earnedStrength)..")"
		EarnedTxt.TextXAlignment = Enum.TextXAlignment.Left
		EarnedTxt.Parent = InnerSecond

		local PingTxt = Instance.new("TextLabel")
		PingTxt.BackgroundTransparency = 1
		PingTxt.Size = UDim2.new(0.9,0,0.15,0)
		PingTxt.Position = UDim2.new(0.05,0,0.21,0)
		PingTxt.Font = Enum.Font.GothamBold
		PingTxt.TextSize = 20
		PingTxt.TextColor3 = Color3.new(1,1,1)
		PingTxt.TextStrokeTransparency = 0
		PingTxt.Text = "Ping: 0 ms"
		PingTxt.TextXAlignment = Enum.TextXAlignment.Left
		PingTxt.Parent = InnerSecond

		local DWTxt = Instance.new("TextLabel")
		DWTxt.BackgroundTransparency = 1
		DWTxt.Size = UDim2.new(0.9,0,0.15,0)
		DWTxt.Position = UDim2.new(0.05,0,0.39,0)
		DWTxt.Font = Enum.Font.GothamBold
		DWTxt.TextSize = 20
		DWTxt.TextColor3 = Color3.new(1,1,1)
		DWTxt.TextStrokeTransparency = 0
		DWTxt.Text = "DWs: 0"
		DWTxt.TextXAlignment = Enum.TextXAlignment.Left
		DWTxt.Parent = InnerSecond

		local TimerTxt = Instance.new("TextLabel")
		TimerTxt.BackgroundTransparency = 1
		TimerTxt.Size = UDim2.new(0.9,0,0.15,0)
		TimerTxt.Position = UDim2.new(0.05,0,0.57,0)
		TimerTxt.Font = Enum.Font.GothamBold
		TimerTxt.TextSize = 20
		TimerTxt.TextColor3 = Color3.new(1,1,1)
		TimerTxt.TextStrokeTransparency = 0
		TimerTxt.Text = "Session Time: 0d 0h 0m 0s"
		TimerTxt.TextXAlignment = Enum.TextXAlignment.Left
		TimerTxt.Parent = InnerSecond

		-- ===== SKYBOX BUTTON =====
		local SkyBtn = Instance.new("TextButton")
		SkyBtn.Size = UDim2.new(0,200,0,40)
		SkyBtn.Position = UDim2.new(0.5,-100,0.75,0)
		SkyBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
		SkyBtn.TextColor3 = Color3.fromRGB(255,255,255)
		SkyBtn.Font = Enum.Font.GothamBold
		SkyBtn.TextSize = 18
		SkyBtn.Text = "Skybox: "..Skyboxes[currentSkyIndex].Name
		SkyBtn.Parent = InnerSecond

		SkyBtn.MouseButton1Click:Connect(function()
			currentSkyIndex += 1
			if currentSkyIndex > #Skyboxes then currentSkyIndex = 1 end
			applySkybox(currentSkyIndex)
			SkyBtn.Text = "Skybox: "..Skyboxes[currentSkyIndex].Name
		end)

		-- ===== PAGE 2 UPDATES =====
		task.spawn(function()
			while SecondPage and SecondPage.Parent do
				EarnedTxt.Text = "Earned: "..formatNumberWithCommas(earnedStrength).." ("..abbreviateNumber(earnedStrength)..")"
				local ping = math.floor(game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue())
				PingTxt.Text = "Ping: "..ping.." ms"

				local DWs = 0
				for i,v in pairs(game.Workspace:GetDescendants()) do
					if v:IsA("Model") and v:FindFirstChild("Owner") and v:FindFirstChild("Hitbox") then
						if v.Owner.Value == Plr then
							DWs += 1
						end
					end
				end
				DWTxt.Text = "DWs: "..DWs

				local totalSec = os.time() - sessionStart
				local days = math.floor(totalSec / 86400)
				local hours = math.floor((totalSec % 86400)/3600)
				local mins = math.floor((totalSec % 3600)/60)
				local secs = totalSec % 60
				TimerTxt.Text = string.format("Session Time: %dd %dh %dm %ds", days, hours, mins, secs)

				task.wait(1)
			end
		end)

		-- ===== DRAG SECOND PAGE =====
		local dragToggle2, dragStart2, startPos2
		local function updateInput2(input)
			local delta = input.Position - dragStart2
			SecondPage.Position = UDim2.new(
				startPos2.X.Scale, startPos2.X.Offset + delta.X,
				startPos2.Y.Scale, startPos2.Y.Offset + delta.Y
			)
		end

		SecondPage.InputBegan:Connect(function(input)
			if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
				dragToggle2 = true
				dragStart2 = input.Position
				startPos2 = SecondPage.Position
				input.Changed:Connect(function()
					if input.UserInputState == Enum.UserInputState.End then
						dragToggle2 = false
					end
				end)
			end
		end)

		UIS.InputChanged:Connect(function(input)
			if dragToggle2 and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
				updateInput2(input)
			end
		end)

	else
		pageOpen = false
		ToggleBtn.Text = ">"
		if SecondPage then
			SecondPage:Destroy()
			SecondPage = nil
		end
	end
end)
